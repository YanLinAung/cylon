<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta content="A Cylon.JS code example" name="description">
<meta content="The Hybrid Group" name="author">
<title>Cylon.JS Example - Sphero Collisions</title>
<link href="/stylesheets/style.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script src="/javascripts/script.js"></script><link href="//fonts.googleapis.com/css?family=Inconsolata:400,700%7CMontserrat:700" rel="stylesheet">
<link href="/favicon.ico" rel="shortcut icon" type="image/gif">
<script type="text/javascript">

  var _gaq = _gaq || [];

  _gaq.push(['_setAccount', "UA-46433484-2"]);







  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script></head>
<body>
    
    <div class="app">
      <div class="w">
        <header class="app-header" role="banner"><div class="display">
            <h1 class="app-logo">
              <a href="/">Cylon</a>
            </h1>
            <span class="subtitle">
              <div class="main"></div>
            </span>
          </div>
          <span class="menu">
            <a href="/documentation" class="item">Docs</a>
            <a href="/hardware" class="item">Hardware</a>
            
            <a href="/blog" class="item">Blog</a>
            <a class="item" target="blanck" href="https://github.com/hybridgroup/cylon/">Github</a>
          </span>
        </header>
</div>
      <div class="page-title">
        <div class="w">
          <h1 class="title">Example: Sphero Collisions</h1>
          <h2 class="subtitle">You can find more versions of this example <a href="https://github.com/hybridgroup/cylon/tree/master/examples/sphero_collision" target="blank" class="repository">here.</a>
</h2>
        </div>
      </div>
      <div class="container">
        <div class="main" role="main">
          <section class="content full"><div class="documentation">
              <h1 id="sphero-collisions">Sphero Collisions</h1>
              
              <p>For this Cylon example, we're going to set up a Sphero such that it will change
              it's color and roll in a random direction when it has a collision.</p>
              
              <p>Before we get started, make sure you have the <code>cylon-sphero</code> module installed.</p>
              
              <p>First, let's load up Cylon:</p>
              
              <pre class="CodeRay">Cylon = require 'cylon'
</pre>
              
              <p>With that loaded, we can begin defining our robot.</p>
              
              <pre class="CodeRay">Cylon.robot
</pre>
              
              <p>We're going to have one connection, and one device for this robot, both the same
              Sphero.</p>
              
              <pre class="CodeRay">  connection: { name: 'sphero', adaptor: 'sphero', port: '/dev/rfcomm0' }
  device: { name: 'sphero', driver: 'sphero' }
</pre>
              
              <p>With the necessary hardware defined, we can now start telling Cylon about the
              work our robot will be performing.</p>
              
              <pre class="CodeRay">  work: (me) -&gt;
</pre>
              
              <p>We'll assign some variables here for later, a basic color for our sphero and
              a variable we'll use for a bitwise math operation later.</p>
              
              <pre class="CodeRay">    color = 0x00FF00
    bitFilter = 0xFFFF00
</pre>
              
              <p>When our Sphero emits the 'connect' event, we're going to hook up collision
              detection, make sure it's not moving, and set a color.</p>
              
              <pre class="CodeRay">    me.sphero.on 'connect', -&gt;
      console.log "Setting up Collision Detection..."
      me.sphero.detectCollisions()
      me.sphero.setRGB color
      me.sphero.stop()
</pre>
              
              <p>And when our Sphero detects a collision, we want to notify the user of this via
              the console.</p>
              
              <pre class="CodeRay">me.sphero.on 'collision', (data) -&gt;
  console.log "Collision:"
</pre>
              
              <p>We get the new color for a Sphero by doing a bitwise XOR operation on it, using
              the bitfilter above.</p>
              
              <pre class="CodeRay">  color = color ^ bitFilter
</pre>
              
              <p>With our new color in hand, we can let the user know what color we're using now,
              and change the Sphero to that color. We'll also tell the Sphero to roll in
              a random direction, at speed 90.</p>
              
              <pre class="CodeRay">  console.log "Color: #{color.toString(16)} "
  me.sphero.setRGB color

  me.sphero.roll 90, Math.floor(Math.random() * 360)
</pre>
              
              <p>And with all that said and done, we can now start the robot.</p>
              
              <p>.start()</p>
            </div>
          </section>
</div>
      </div>
    </div>
    <footer class="app-footer"><div class="w">
        <div class="copyright">
          Â© Copyright 2012-2014
          <a href="http://hybridgroup.com">The Hybrid Group.</a>
        </div>
      </div>
    </footer>
</body>
</html>
